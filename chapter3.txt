This is chapter 3 for the master branch